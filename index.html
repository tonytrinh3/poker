<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<style>

    body{
        background-color: green;
    }

    button{
        border: none;
        outline: none;
        background-color: green;
    }

</style>
<body>
    <div class="player-1">
        <button class = "card card-11"></button>
        <button class = "card card-12"></button>
        <button class = "card card-13"></button>
        <button class = "card card-14"></button>
        <button class = "card card-15"></button>
    </div>
    <br/>
    <div class="player-2">
        <button class = "card card-21"></button>
        <button class = "card card-22"></button>
        <button class = "card card-23"></button>
        <button class = "card card-24"></button>
        <button class = "card card-25"></button>
    </div>
</body>
<script src = "./pokersolver-master/pokersolver.js">

</script>
<script>

    const state = {};



    // const fetchAsyncA = async () => await (await fetch('https://api.github.com')).json()
    // https://gist.github.com/msmfsd/fca50ab095b795eb39739e8c4357a808
    
    const getDeckOfCards = async () => {


        try{
            const result = await fetch('https://deckofcardsapi.com/api/deck/new/shuffle/?deck_count=1');
            const data = await result.json();
            

            //this is an array of 5 
            const playerOne = await(await fetch(`https://deckofcardsapi.com/api/deck/${data.deck_id}/draw/?count=5`)).json();
            
            const playerTwo= await(await fetch(`https://deckofcardsapi.com/api/deck/${data.deck_id}/draw/?count=5`)).json();
            

            //https://stackoverflow.com/questions/33846682/react-onclick-function-fires-on-render/33846747
            //Because you are calling that function instead of passing the function to onClick, change that line to this:


            let count = 0;
            console.log(count);

            
            const renderCard = (cards,playerNumber) =>{
                cards.forEach((curEl, index) => {
                    const displayCard = `<img src = ${curEl.image} alt = ${curEl.code}/>`;

                    const cardIndex = playerNumber+index+1;

                    document.querySelector(`.card-${cardIndex}`).insertAdjacentHTML('beforeend',displayCard);

                    //https://dev.to/karataev/set-css-styles-with-javascript-3nl5
                    let style = document.createElement('style');
                    style.innerHTML = `
                    .card-${index+1} {
                    background-color: green;
                    }
                    `;
                    document.head.appendChild(style);

                    //render new card
                    document.querySelector(`.card-${cardIndex}`).addEventListener('click', async () =>{   
                        count++
                        console.log(count);
                        const newCard = await(await fetch(`https://deckofcardsapi.com/api/deck/${data.deck_id}/draw/?count=1`)).json();
                        const displayNewCard = `<img src = ${newCard.cards[0].image} alt = ${newCard.cards[0].code}>`;
                        const el = document.querySelector(`.card-${cardIndex}`);
                            
                        
                        //https://www.w3schools.com/jsref/met_node_removechild.asp
                        el.removeChild(el.childNodes[0]);
                        el.disabled=true;
                        
                        //https://dev.to/karataev/set-css-styles-with-javascript-3nl5
                        let style = document.createElement('style');
                        style.innerHTML = `
                        .card-${cardIndex} {
                        background-color: red;
                        border-radius: 10px;
                        padding: 4px;
                        }
                        `;
                        document.head.appendChild(style);

                        document.querySelector(`.card-${cardIndex}`).insertAdjacentHTML('beforeend', displayNewCard);

                                        
                        if (count === 3){
                            document.querySelectorAll(`.card`).disabled = true;
                    
                            let style = document.createElement('style');
                            style.innerHTML = `
                            .card {
                            background-color: red;
                            border-radius: 10px;
                            padding: 4px;
                            }
                            `;
                            document.head.appendChild(style);
                        }

                    });
                });
            };

        renderCard(playerOne.cards,10);
        renderCard(playerTwo.cards,20);
            
        
        } catch (error){
            alert(error);
        }
       
    };

    getDeckOfCards();
    
</script>
</html>